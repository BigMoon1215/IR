<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>수행평가 일정 관리</title>
    <style>
        body { 
            font-family: 'Arial', sans-serif; 
            margin: 0; 
            padding: 20px; 
            background-color: #f4f4f9; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            flex-direction: column; /* 수직 정렬 */
            height: 100vh; 
            overflow-y: auto; /* 세로 스크롤 가능 */
        }
        .container { 
            max-width: 600px; 
            width: 100%; 
            background: white; 
            border-radius: 8px; 
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); 
            padding: 20px; 
            position: relative; 
        }
        h1, h2 { 
            text-align: center; 
            color: #333; 
        }
        .date-picker, .evaluation-list { 
            margin-bottom: 20px; 
            text-align: center; 
        }
        .evaluation-item { 
            margin-bottom: 10px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            padding: 10px; 
            border: 1px solid #ddd; 
            border-radius: 5px; 
            background: #fafafa; 
        }
        .input-group { 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            margin-bottom: 10px; 
            flex-wrap: wrap; /* 요소들이 줄바꿈 가능하게 */
        }
        button { 
            background: #007bff; 
            color: white; 
            border: none; 
            border-radius: 5px; 
            padding: 8px 12px; 
            cursor: pointer; 
            transition: background 0.3s; 
            margin-left: 5px; /* 버튼 간격 조정 */
            flex-shrink: 0; /* 버튼 크기 고정 */
        }
        button:hover { 
            background: #0056b3; 
        }
        select, input[type="text"], input[type="date"], input[type="month"] { 
            padding: 10px; 
            margin: 5px; 
            border: 1px solid #ddd; 
            border-radius: 5px; 
            font-size: 14px; 
            flex: 1; /* 입력 필드가 공간을 고르게 차지하도록 설정 */
        }
        input[type="month"] { 
            flex: 0.5; /* 월 입력 필드의 크기 조정 */
        }
        .evaluation-list h2 { 
            margin-top: 0; 
        }
    </style>
</head>
<body>

<div class="container">
    <h1>수행평가 일정 관리</h1>
    
    <div class="date-picker">
        <label for="month">날짜 선택:</label>
        <input type="month" id="month" value="2024-10">
        <button onclick="updateEvaluations()">조회</button>
    </div>

    <div>
        <h2>수행평가 추가</h2>
        <div class="input-group">
            <input type="date" id="evaluationDate">
            <select id="category">
                <option value="">과목 선택</option>
                <option value="국어">국어</option>
                <option value="수학">수학</option>
                <option value="영어">영어</option>
                <option value="사회">사회</option>
                <option value="과학">과학</option>
                <option value="한국사">한국사</option>
                <option value="정보">정보</option>
                <option value="미술">미술</option>
                <option value="음악">음악</option>
                <option value="체육">체육</option>
            </select>
            <input type="text" id="evaluation" placeholder="수행평가 내용">
            <button onclick="addEvaluation()">추가</button>
        </div>
    </div>

    <div class="evaluation-list" id="evaluationList">
        <h2>등록된 수행평가</h2>
        <div id="evaluations"></div>
    </div>
</div>

<script>
    // 수행평가 데이터 저장소
    const evaluations = JSON.parse(localStorage.getItem('evaluations')) || {};

    function updateEvaluations() {
        const month = document.getElementById('month').value;
        const evalList = document.getElementById('evaluations');
        evalList.innerHTML = '';

        // 현재 선택한 년도와 달을 기반으로 데이터 확인
        if (evaluations[month] && evaluations[month].length > 0) {
            // 날짜 기준으로 정렬
            evaluations[month].sort((a, b) => new Date(a.date) - new Date(b.date));

            evaluations[month].forEach((item, index) => {
                const div = document.createElement('div');
                div.className = 'evaluation-item';
                div.textContent = `${item.date}: ${item.category} - ${item.content}`;

                // 수정 버튼
                const editButton = document.createElement('button');
                editButton.textContent = '수정';
                editButton.onclick = () => editEvaluation(month, index);
                div.appendChild(editButton);

                // 삭제 버튼
                const deleteButton = document.createElement('button');
                deleteButton.textContent = '삭제';
                deleteButton.onclick = () => deleteEvaluation(month, index);
                div.appendChild(deleteButton);

                evalList.appendChild(div);
            });
        } else {
            evalList.textContent = '등록된 수행평가가 없습니다.';
        }
    }

    function addEvaluation() {
        const month = document.getElementById('month').value;
        const category = document.getElementById('category').value;
        const evaluationInput = document.getElementById('evaluation').value;
        const evaluationDate = document.getElementById('evaluationDate').value;

        if (evaluationInput && category && evaluationDate) {
            const newEvaluation = {
                date: evaluationDate,
                category: category,
                content: evaluationInput
            };

            // 년도와 월로 데이터 저장소 초기화
            const evaluationMonth = evaluationDate.substring(0, 7); // YYYY-MM 형식으로 월 추출
            if (!evaluations[evaluationMonth]) {
                evaluations[evaluationMonth] = [];
            }
            evaluations[evaluationMonth].push(newEvaluation);
            localStorage.setItem('evaluations', JSON.stringify(evaluations)); // 데이터 저장
            alert('수행평가가 추가되었습니다!');
            document.getElementById('evaluation').value = '';
            updateEvaluations();
        } else {
            alert('수행평가 내용을 입력하고 과목을 선택하세요.');
        }
    }

    function editEvaluation(month, index) {
        const evaluation = evaluations[month][index];
        
        // 수정할 내용을 입력받기 위한 요소 생성
        const dateInput = document.createElement('input');
        dateInput.type = 'date';
        dateInput.value = evaluation.date;

        const categorySelect = document.createElement('select');
        categorySelect.innerHTML = `
            <option value="">과목 선택</option>
            <option value="국어" ${evaluation.category === '국어' ? 'selected' : ''}>국어</option>
            <option value="수학" ${evaluation.category === '수학' ? 'selected' : ''}>수학</option>
            <option value="영어" ${evaluation.category === '영어' ? 'selected' : ''}>영어</option>
            <option value="사회" ${evaluation.category === '사회' ? 'selected' : ''}>사회</option>
            <option value="과학" ${evaluation.category === '과학' ? 'selected' : ''}>과학</option>
            <option value="한국사" ${evaluation.category === '한국사' ? 'selected' : ''}>한국사</option>
            <option value="정보" ${evaluation.category === '정보' ? 'selected' : ''}>정보</option>
            <option value="미술" ${evaluation.category === '미술' ? 'selected' : ''}>미술</option>
            <option value="음악" ${evaluation.category === '음악' ? 'selected' : ''}>음악</option>
            <option value="체육" ${evaluation.category === '체육' ? 'selected' : ''}>체육</option>
        `;

        const contentInput = document.createElement('input');
        contentInput.type = 'text
        contentInput.type = 'text';
        contentInput.value = evaluation.content;
        contentInput.placeholder = '수행평가 내용';

        // 수정 완료 버튼
        const updateButton = document.createElement('button');
        updateButton.textContent = '수정 완료';
        updateButton.onclick = () => {
            const newDate = dateInput.value;
            const newCategory = categorySelect.value;
            const newContent = contentInput.value;

            if (newDate && newCategory && newContent) {
                evaluations[month][index] = {
                    date: newDate,
                    category: newCategory,
                    content: newContent
                };
                localStorage.setItem('evaluations', JSON.stringify(evaluations)); // 데이터 저장
                updateEvaluations();
            } else {
                alert('모든 필드를 입력하세요.');
            }
        };

        // 수정할 항목을 보여주기 위한 div 생성
        const editDiv = document.createElement('div');
        editDiv.className = 'input-group';
        editDiv.appendChild(dateInput);
        editDiv.appendChild(categorySelect);
        editDiv.appendChild(contentInput);
        editDiv.appendChild(updateButton);

        const evaluationItem = document.querySelectorAll('.evaluation-item')[index];
        evaluationItem.innerHTML = ''; // 기존 내용을 지우고
        evaluationItem.appendChild(editDiv); // 새로운 수정 항목 추가
    }

    function deleteEvaluation(month, index) {
        if (confirm('정말로 삭제하시겠습니까?')) {
            evaluations[month].splice(index, 1);
            localStorage.setItem('evaluations', JSON.stringify(evaluations)); // 데이터 저장
            updateEvaluations();
        }
    }

    // 페이지 로드 시 공유된 데이터가 있는지 확인
    window.onload = function() {
        updateEvaluations(); // 초기화 시 현재 월의 수행평가를 업데이트
    };
</script>

</body>
</html>
